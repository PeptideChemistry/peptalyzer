<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Peptalyzer™ Report</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/report_style.css') }}">
</head>
<body>

<div class="page-header">
  Generated by Peptalyzer™ on peptidechemistry.org
</div>

<div class="title-page">
  <img class="logo" src="{{ url_for('static', filename='icons/PeptideChemistry_Logo.svg') }}" alt="Logo">
  <h1>Peptalyzer™ Report</h1>
  <p class="subtitle">peptidechemistry.org // Last Calculation: {{ data.timestamp | datetimeformat }}</p>
</div>

<section>
  <h2>Peptide Sequence</h2>
  <p><strong>Sequence:</strong> {{ data.sequence }}</p>
  <p><strong>Terminus:</strong> {{ data.terminal_modifications }}</p>
</section>

<section>
  <h2>Basic Properties</h2>
  <table>
    <tbody>
      <tr><td>Peptide Length</td><td>{{ data.length }}</td></tr>
      <tr style="background-color: #f0f8ff; font-weight: bold;">
        <td>Isoelectric Point (pI) - IPC 2.0</td>
        <td>{{ data.isoelectric_point }}</td>
      </tr>
      <tr><td style="padding-left: 20px;">└ Bjellqvist scale</td><td>{{ data.pi_scales.bjellqvist }}</td></tr>
      <tr><td style="padding-left: 20px;">└ EMBOSS scale</td><td>{{ data.pi_scales.emboss }}</td></tr>
      <tr><td style="padding-left: 20px;">└ Lehninger scale</td><td>{{ data.pi_scales.lehninger }}</td></tr>
      
      <tr><td>Net Charge at Selected pH ({{ data.selected_pH }})</td><td>{{ data.charge_at_pH }}</td></tr>
      <tr><td>GRAVY Score</td><td>{{ data.gravy_value }} ({{ data.gravy_classification }})</td></tr>
      <tr><td>Peptide Polarity</td><td>{{ data.peptide_polarity }}</td></tr>
      <tr><td>Molecular Formula</td><td>{{ data.molecular_formula.formatted }}</td></tr>
    </tbody>
  </table>
</section>

<section class="page-break">
  <h2>Molecular and Structural Characteristics</h2>
  <table>
    <tbody>
      <tr><td>Monoisotopic Mw</td><td>{{ data.monoisotopic_mw }} Da</td></tr>
      <tr><td>Average Mw</td><td>{{ data.average_mw }} Da</td></tr>
      <tr><td>Intramolecular SS Bonds</td><td>{{ data.intra_disulfide_bonds }}</td></tr>
      <tr><td>Intermolecular SS Bonds</td><td>{{ data.inter_disulfide_bonds }}</td></tr>
      <tr><td>Peptide State</td><td>{{ data.peptide_state }}</td></tr>
      <tr><td>Extinction Coefficient</td><td>{{ data.extinction_coefficient.adjusted }} {{ data.extinction_coefficient.unit }}</td></tr>
      <tr><td>Acidic Residues</td><td>{{ data.charge_distribution.acidic_count }}</td></tr>
      <tr><td>Basic Residues</td><td>{{ data.charge_distribution.basic_count }}</td></tr>
      <tr><td>Total Charged Residues</td><td>{{ data.total_charge_residues }}</td></tr>
      <tr><td>Boman Index</td><td>{{ data.boman_index }}</td></tr>
      <tr><td>Aliphatic Index</td><td>{{ data.aliphatic_index.value }}% ({{ data.aliphatic_index.rating }})</td></tr>
      <tr><td>Aromaticity</td><td>{{ data.aromaticity.value }}</td></tr>
      <tr><td>Instability Index</td><td>{{ data.instability_index.value }}</td></tr>
      <tr><td>Helix (%)</td><td>{{ data.secondary_structure.helix }}</td></tr>
      <tr><td>Sheet (%)</td><td>{{ data.secondary_structure.sheet }}</td></tr>
      <tr><td>Coil (%)</td><td>{{ data.secondary_structure.coil }}</td></tr>
    </tbody>
  </table>
</section>

<section class="page-break">
  <h2>Amino Acid Counts</h2>
  <table>
    <thead>
      <tr>
        <th>Amino Acid</th>
        <th>Count</th>
        <th>Percent (%)</th>
      </tr>
    </thead>
    <tbody>
        {% for aa, count in data.amino_acid_counts.items()|sort %}
        <tr>
          <td>{{ aa }}</td>
          <td>{{ count }}</td>
          <td>{{ "%.1f"|format(count / data.length * 100) }}%</td>
        </tr>
        {% endfor %}
      </tbody>
  </table>
</section>

<section class="page-break">
  <h2>Graphs</h2>
  <div class="graph-block">
    <h3>Net Charge vs pH</h3>
    <img src="data:image/png;base64,{{ data.net_charge_plot }}">
  </div>
  <div class="graph-block">
    <h3>Charge Distribution Pie Chart</h3>
    <img src="data:image/png;base64,{{ data.charge_distribution_pie }}">
  </div>
  <div class="graph-block">
    <h3>Hydropathy Profile - Kyte-Doolittle</h3>
    <img src="data:image/png;base64,{{ data.hydropathy_plot }}">
  </div>
  <div class="graph-block">
    <h3>Hydrophilicity Profile - Hopp-Woods</h3>
    <img src="data:image/png;base64,{{ data.hopp_woods_plot }}">
  </div>
</section>

<footer class="report-footer">
  <p>Peptalyzer™ Version: 1.2.1</p>
  <p><a href="https://peptidechemistry.org/contact/">Contact Support</a> | <a href="https://peptidechemistry.org/peptalyzer/resources">Resources</a></p>
  <p>© 2025 • Peptide Chemistry</p>
</footer>

</body>
</html>